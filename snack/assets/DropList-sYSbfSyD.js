import{j as o}from"./jsx-runtime-BTJTZTIL.js";import{c as d4}from"./index-DUmpqB7p.js";import{m as E4}from"./index-B7wZyJkK.js";import{r as t}from"./index-CJ_LmFaV.js";import{u as m4,k as V,e as p4,a as c4,N as f4,S as D4,C as B4,F as A4,O as F4,L as C4,s as v4,I as E}from"./hooks-Cv-w_Cx5.js";import{u as L}from"./useValueControl-C51frgGe.js";import{D as y4}from"./Dropdown-uG1Hplv7.js";const b4=["top","right","bottom","left"];function w({items:F,search:C,pinBottom:g=[],pinTop:q=[],footerActiveElementsRefs:j,children:l,trigger:M,placement:_,widthStrategy:K,triggerElemRef:f,open:P,onOpenChange:H,collapse:z={},triggerClassName:G,selection:r,contentRender:U,size:X="s",marker:J=!0,closeDroplistOnItemClick:Q=!1,className:W,listRef:Y,untouchableScrollbars:Z=!1,virtualized:S=!1,closeOnPopstate:$,...u4}){const h=t.useMemo(()=>!!C,[C]),[v=[],R]=L(z),e4=t.useCallback(u=>R(e=>e!=null&&e.includes(u)?e.filter(a=>a!==u):(e??[]).concat([u])),[R]),[t4=!1,i]=L({value:P,defaultValue:!1,onChange:H}),{searchItem:m,footerItems:D}=m4({footerActiveElementsRefs:j}),{flattenItems:a4,focusFlattenItems:x,...p}=t.useMemo(()=>{const u=V({items:q,prefix:E.pinTop,parentId:E.default}),e=V({items:F,prefix:E.default,parentId:E.default}),a=V({items:g,prefix:E.pinBottom,parentId:E.default}),s={...u.flattenItems,...a.flattenItems,...e.flattenItems},d={...u.focusFlattenItems,...a.focusFlattenItems,...e.focusFlattenItems};return[...D,m].forEach(n=>{s[n.id]=n,d[n.id]={...n,originalId:n.id,items:[],key:n.id,allChildIds:[]}}),{items:e,pinTop:u,pinBottom:a,flattenItems:s,focusFlattenItems:d}},[F,q,g,m,D]),{ids:B,expandedIds:k}=t.useMemo(()=>{const{pinTop:u,items:e,pinBottom:a}=p;let s=[],d=[];return h&&s.push(m.id),[u,e,a].forEach(({focusFlattenItems:n,focusCloseChildIds:i4})=>{const T=p4({focusFlattenItems:n,focusCloseChildIds:i4,openCollapseItems:v,isSelectionMultiple:(r==null?void 0:r.mode)==="multiple"});s=s.concat(T.ids),d=d.concat(T.expandedIds)}),D.forEach(n=>{s.push(n.id)}),{ids:s,expandedIds:d}},[D,h,p,v,m.id,r==null?void 0:r.mode]),y=t.useRef(null),N=t.useRef(null),O=B[0],{handleListKeyDownFactory:b,resetActiveItemId:c,activeItemId:l4,forceUpdateActiveItemId:A}=c4({mainRef:f??y,focusFlattenItems:x,hasListInFocusChain:!0,firstItemId:O}),n4=t.useCallback(u=>b(B,k)(u),[b,B,k]),s4=t.useCallback(u=>{c(),i(u)},[c,i]),I=t.useCallback((u,e)=>{u.key==="ArrowDown"&&(u.preventDefault(),i(!0),setTimeout(()=>{var a;c(),(a=N.current)==null||a.focus()},0)),u.key==="ArrowUp"&&i(!1),e==null||e(u)},[c,i]),o4=t.useMemo(()=>t.isValidElement(l),[l]),r4=t.useMemo(()=>{if(t.isValidElement(l)){const u=typeof l.props=="object"?l.props:{};return t.cloneElement(l,{...u,onKeyDown:e=>{var a;I(e,(a=l.props)==null?void 0:a.onKeyDown)}})}return typeof l=="function"?l({onKeyDown:I}):l},[I,l]);return o.jsx(f4,{flattenItems:a4,focusFlattenItems:x,contentRender:U,size:X,marker:J,firstItemId:O,virtualized:S,children:o.jsx(D4,{...r,children:o.jsx(B4.Provider,{value:{openCollapseItems:v,toggleOpenCollapseItem:e4},children:o.jsx(A4.Provider,{value:{activeItemId:l4,handleListKeyDownFactory:b,forceUpdateActiveItemId:A},children:o.jsx(F4.Provider,{value:{closeDroplistOnItemClick:Q,closeDroplist:()=>{var u;i(!1),c(),(u=(f??y).current)==null||u.focus()}},children:o.jsx(y4,{content:o.jsx("div",{className:d4(v4.wrapper,W),children:o.jsx(C4,{...u4,items:p.items.focusCloseChildIds,pinTop:p.pinTop.focusCloseChildIds,pinBottom:p.pinBottom.focusCloseChildIds,virtualized:S,onKeyDown:n4,searchItem:m,tabIndex:0,ref:E4(N,Y),search:C,onFocus:u=>{u.stopPropagation(),A==null||A(B[0])},limitedScrollHeight:!0,untouchableScrollbars:Z})}),outsideClick:!0,triggerClassName:G,fallbackPlacements:b4,trigger:M,placement:_,widthStrategy:K,triggerRef:f?o4&&f||void 0:y,open:t4,onOpenChange:s4,closeOnPopstate:$,children:r4})})})})})})}try{w.displayName="Droplist",w.__docgenInfo={description:"",displayName:"Droplist",props:{triggerElemRef:{defaultValue:null,description:"Ссылка на элемент-триггер для дроплиста",name:"triggerElemRef",required:!1,type:{name:"RefObject<HTMLElement>"}},listRef:{defaultValue:null,description:"Ссылка на элемент выпадающего списка",name:"listRef",required:!1,type:{name:"RefObject<HTMLElement>"}},closeDroplistOnItemClick:{defaultValue:{value:"false"},description:`Закрывать выпадающий список после клика на базовый айтем.

Работает в режимах selection: 'none' | 'single'`,name:"closeDroplistOnItemClick",required:!1,type:{name:"boolean"}},virtualized:{defaultValue:{value:"false"},description:"Включить виртуализацию на компоненты списка. Рекомендуется если у вас от 1к элементов списка",name:"virtualized",required:!1,type:{name:"boolean"}},children:{defaultValue:null,description:"Триггер для дроплиста",name:"children",required:!0,type:{name:"ReactNode | ({onKeyDown}) => ReactNode * Рендер функция принимает аргументы `onKeyDown` - хендлер ввода, для поддержки управления с клавиатуры"}},triggerClassName:{defaultValue:null,description:"CSS-класс триггера",name:"triggerClassName",required:!1,type:{name:"string"}},open:{defaultValue:null,description:"Управляет состоянием показан/не показан.",name:"open",required:!1,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"Колбек отображения компонента. Срабатывает при изменении состояния open.",name:"onOpenChange",required:!1,type:{name:"((isOpen: boolean) => void)"}},widthStrategy:{defaultValue:{value:"auto"},description:"Стратегия управления шириной контейнера поповера\n<br> - `auto` - соответствует ширине контента,\n<br> - `gte` - Great Than or Equal, равен ширине таргета или больше ее, если контент в поповере шире,\n<br> - `eq` - Equal, строго равен ширине таргета.",name:"widthStrategy",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"gte"'},{value:'"eq"'}]}},closeOnPopstate:{defaultValue:null,description:"Закрывать ли поповер при пекреходе по истории браузера",name:"closeOnPopstate",required:!1,type:{name:"boolean"}},trigger:{defaultValue:null,description:"Условие отображения поповера:\n<br> - `click` - открывать по клику\n<br> - `hover` - открывать по ховеру\n<br> - `focusVisible` - открывать по focus-visible\n<br> - `focus` - открывать по фокусу\n<br> - `hoverAndFocusVisible` - открывать по ховеру и focus-visible\n<br> - `hoverAndFocus` - открывать по ховеру и фокусу\n<br> - `clickAndFocusVisible` - открывать по клику и focus-visible",name:"trigger",required:!1,type:{name:"enum",value:[{value:'"hover"'},{value:'"click"'},{value:'"focusVisible"'},{value:'"focus"'},{value:'"hoverAndFocusVisible"'},{value:'"hoverAndFocus"'},{value:'"clickAndFocusVisible"'}]}},placement:{defaultValue:{value:"top"},description:"Положение поповера относительно своего триггера (children).",name:"placement",required:!1,type:{name:"enum",value:[{value:'"left"'},{value:'"left-start"'},{value:'"left-end"'},{value:'"right"'},{value:'"right-start"'},{value:'"right-end"'},{value:'"top"'},{value:'"top-start"'},{value:'"top-end"'},{value:'"bottom"'},{value:'"bottom-start"'},{value:'"bottom-end"'}]}},"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"CSS-класс",name:"className",required:!1,type:{name:"string"}},footer:{defaultValue:null,description:"Кастомизируемый элемент в конце списка",name:"footer",required:!1,type:{name:"ReactNode ;"}},search:{defaultValue:null,description:"Настройки поисковой строки",name:"search",required:!1,type:{name:"SearchState"}},marker:{defaultValue:{value:"true"},description:"Отображать ли маркер у выбранного жлемента списка",name:"marker",required:!1,type:{name:"boolean"}},size:{defaultValue:{value:"s"},description:"Размер списка",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"l"'}]}},onScroll:{defaultValue:null,description:"Колбек на скролл прокручиваемого списка",name:"onScroll",required:!1,type:{name:"((event?: Event) => void)"}},loading:{defaultValue:null,description:"Флаг, отвещающий за состояние загрузки списка",name:"loading",required:!1,type:{name:"boolean"}},items:{defaultValue:null,description:"Основные элементы списка",name:"items",required:!0,type:{name:"Item[]"}},pinTop:{defaultValue:null,description:"Элементы списка, закрепленные сверху",name:"pinTop",required:!1,type:{name:"Item[]"}},pinBottom:{defaultValue:null,description:"Элементы списка, закрепленные снизу",name:"pinBottom",required:!1,type:{name:"Item[]"}},footerActiveElementsRefs:{defaultValue:null,description:"Список ссылок на кастомные элементы, помещенные в специальную секцию внизу списка",name:"footerActiveElementsRefs",required:!1,type:{name:"RefObject<HTMLElement>[]"}},collapse:{defaultValue:{value:"{}"},description:"Настройки раскрытия элементов",name:"collapse",required:!1,type:{name:"CollapseState"}},scrollToSelectedItem:{defaultValue:null,description:"Флаг, отвещающий за прокручивание до выбранного элемента",name:"scrollToSelectedItem",required:!1,type:{name:"boolean"}},scrollContainerClassName:{defaultValue:null,description:"CSS-класс для scroll обертки основного списка айтемов",name:"scrollContainerClassName",required:!1,type:{name:"string"}},selection:{defaultValue:null,description:"",name:"selection",required:!1,type:{name:"SelectionMultipleState | SelectionSingleState"}},contentRender:{defaultValue:null,description:"Рендер функция основного контента айтема",name:"contentRender",required:!1,type:{name:"((props: ContentRenderProps) => ReactNode)"}},scroll:{defaultValue:null,description:"Включить ли скролл для основной части списка",name:"scroll",required:!1,type:{name:"boolean"}},scrollRef:{defaultValue:null,description:"Ссылка на элемент, обозначающий самый конец прокручиваемого списка",name:"scrollRef",required:!1,type:{name:"RefObject<HTMLElement>"}},scrollContainerRef:{defaultValue:null,description:"Ссылка на контейнер, который скроллится",name:"scrollContainerRef",required:!1,type:{name:"RefObject<HTMLElement>"}},untouchableScrollbars:{defaultValue:{value:"false"},description:"Отключает возможность взаимодействовать со скролбарами мышью.",name:"untouchableScrollbars",required:!1,type:{name:"boolean"}},barHideStrategy:{defaultValue:null,description:"Управление скрытием скролл баров:\n<br> - `Never` - показывать всегда\n<br> - `Leave` - скрывать когда курсор покидает компонент\n<br> - `Scroll` - показывать только когда происходит скроллинг\n<br> - `Move` - показывать при движении курсора над компонентом",name:"barHideStrategy",required:!1,type:{name:"enum",value:[{value:'"move"'},{value:'"scroll"'},{value:'"never"'},{value:'"leave"'}]}},dataFiltered:{defaultValue:null,description:"",name:"dataFiltered",required:!1,type:{name:"boolean"}},dataError:{defaultValue:null,description:"",name:"dataError",required:!1,type:{name:"boolean"}},noDataState:{defaultValue:null,description:"Экран при отстутствии данных",name:"noDataState",required:!1,type:{name:"EmptyStateProps"}},noResultsState:{defaultValue:null,description:"Экран при отстутствии результатов поиска или фильтров",name:"noResultsState",required:!1,type:{name:"EmptyStateProps"}},errorDataState:{defaultValue:null,description:"Экран при ошибке запроса",name:"errorDataState",required:!1,type:{name:"EmptyStateProps"}}}}}catch{}export{w as D};
