import{j as s}from"./jsx-runtime-BTJTZTIL.js";import{a as _u}from"./chunk-D5ZWXAHU-Dm3eDOzv.js";import{r as e}from"./index-CJ_LmFaV.js";import{g as xu}from"./helper-2L10TFcd.js";import{c as K,a as Tu,b as Nu,C as ku,s as Ru}from"./styles.module-BfAkJGR3.js";import{m as Lu}from"./index-B7wZyJkK.js";import{u as Hu}from"./index-JZGyZbA2.js";import{S as G,I as U}from"./constants-9uwKbtvo.js";import{u as Mu,r as Pu}from"./useButtonNavigation-CVCsehRW.js";import{F as Ou,g as ju,C as Ku,V as Gu}from"./FieldDecorator-CLLFAGM0.js";import{C as Uu}from"./index-HYofs7FJ.js";import{D as y,u as Wu,S as I,a as W,b as Yu}from"./useHandlers-CSVwMbx9.js";import{u as $u}from"./useClearButton-DMWmUR1d.js";import{u as zu}from"./useCopyButton-Cm96okR0.js";import{e as Ju}from"./componentPropsProcessors-UJEZy8aQ.js";import{D as Qu}from"./Dropdown-uG1Hplv7.js";import{F as Zu}from"./FieldContainerPrivate-C57rtyBq.js";import{I as Xu}from"./InputPrivate-C6kWfrUd.js";import{C as u4}from"./Calendar-4GuDSEHX.js";import"./index-ChsGqxH_.js";import"./v4-CtRu48qb.js";import"./_commonjsHelpers-D6-XlEtG.js";import"./index-B_WE0pTs.js";import"./Sprite-DoNyyhE0.js";import"./sprite.symbol-DpN2ERsh.js";import"./index-C-NxZ9RO.js";import"./index-Dz039XZe.js";import"./index-DtRrUciF.js";import"./index-BLj3vrxU.js";import"./index-BKaanG2n.js";import"./index-DLGJiw2b.js";import"./index-C7IVzcIX.js";import"./index-CX1lIXbQ.js";import"./index-BQAaeyfQ.js";import"./index-DLRniMSR.js";import"./index-BJ2Oj32Z.js";import"./index-0zxx_KqD.js";import"./index-NU8U5csw.js";import"./index-I1zimRE2.js";import"./index-BIeLB8C9.js";import"./index-BcKv4fI4.js";import"./index-CIcT2jya.js";import"./index-3XDw48l5.js";import"./index-6PN_JoHT.js";import"./index-C9_U387z.js";import"./index-CwHIobxP.js";import"./index-B9oUDl45.js";import"./index-Baw9oej9.js";import"./index-BJDjEDgt.js";import"./index-Drk0xmYR.js";import"./index-zbp_5bxn.js";import"./PopoverPrivate-CnKgsFAm.js";import"./index-Bxu_udwM.js";import"./index-DdXvKv-Q.js";import"./index-DUmpqB7p.js";import"./isBrowser-C2N6XvuH.js";import"./useIsomorphicLayoutEffect-BAXQmlEq.js";import"./TruncateString-BPmgFnBz.js";import"./Tooltip-BNp3usZT.js";import"./index-DTH25FFD.js";import"./TimePickerBase-C7FkWbU9.js";import"./hooks-Cv-w_Cx5.js";import"./useValueControl-C51frgGe.js";import"./Checkbox-uZV6WJ28.js";import"./constants-BObEONKm.js";import"./TogglePrivate-BTSew7b5.js";import"./Switch-CYqDG2NM.js";import"./LocaleProvider-CyhbxqE1.js";import"./index-BkOiuzeN.js";import"./IconPredefined-yX8Rdo-2.js";import"./Typography-DmSN6cv6.js";import"./ButtonTonal-BgeMe9qu.js";import"./utils-Ct1D1GSP.js";import"./Counter-dO15w468.js";import"./Sun-CLMO8Tpr.js";import"./constants-BAH7I9kc.js";import"./ButtonFilled-DhU1yp3w.js";import"./Divider-C1X9zrkx.js";import"./Spinner-DZPrD8kc.js";import"./Scroll-B3e6J9cA.js";import"./ButtonFunction-DkDZEdUd.js";import"./List-CSQrxlMY.js";const e4="_triggerClassName_1tsmy_1",t4="_calendarWrapper_1tsmy_7",a4="_container_1tsmy_24",n4="_calendarIcon_1tsmy_24",g={triggerClassName:e4,calendarWrapper:t4,container:a4,calendarIcon:n4},D=e.forwardRef(({id:c,name:F,value:t,disabled:o=!1,readonly:n=!1,showCopyButton:v=!0,showClearButton:f=!0,open:E,onOpenChange:b,onChange:l,onFocus:d,onBlur:J,className:Q,label:Z,labelTooltip:X,labelTooltipPlacement:uu,required:w=!1,caption:eu,hint:tu,showHintIcon:au,size:r=G.S,validationState:nu=Gu.Default,buildCellProps:ou,error:q,mode:m,onCopyButtonClick:ru,..._},lu)=>{const[S,i]=Hu(E,!1,b),a=e.useRef(null),iu=e.useRef(null),su=e.useRef(null),x=r===G.S?U.Xs:U.S,T=S&&!n&&!o,N=!!(t&&!o),du=f&&N&&!n,pu=v&&N&&n,C=m==="date-time"?_.showSeconds??!0:void 0,k=ju({validationState:nu,error:q}),R=e.useRef(null),L=e.useCallback(u=>{u.key==="ArrowDown"&&(i(!0),setTimeout(()=>{var p;return(p=R.current)==null?void 0:p.focus()},0))},[i]),mu=e.useCallback(()=>{var u,p,j;l&&l(void 0),(u=a.current)!=null&&u.value&&(a.current.value=""),w?((p=a.current)==null||p.focus(),i(!0)):((j=a.current)==null||j.blur(),i(!1))},[l,w,i]),A=e.useCallback(u=>u?m==="date"?u.toLocaleDateString(y):u.toLocaleString(y,{year:"numeric",month:"numeric",day:"numeric",hour:"2-digit",minute:"2-digit",second:C?"2-digit":void 0}):"",[m,C]),cu=A(t),H=$u({clearButtonRef:iu,showClearButton:du,size:r,onClear:mu}),M=zu({copyButtonRef:su,showCopyButton:pu,size:r,valueToCopy:cu,onCopyButtonClick:ru}),P=e.useMemo(()=>({active:!1,show:!0,id:"calendarIcon",render:u=>s.jsx(Uu,{...u,size:x,className:g.calendarIcon,"data-size":r})}),[x,r]),fu=e.useMemo(()=>[H,M,P],[H,M,P]),{value:Eu,handleChange:Fu,handleClick:O,handleKeyDown:Bu,handleBlur:vu,mask:Cu,setInputFocus:B}=Wu({inputRef:a,onChange:l,readonly:n,locale:y,setIsOpen:i,mode:m,showSeconds:C}),Au=e.useCallback(()=>B(m==="date"?I.Year:I.Seconds),[m,B]),{postfixButtons:yu,inputTabIndex:gu,onInputKeyDown:hu,setInitialTabIndices:Du}=Mu({setInputFocus:Au,inputRef:a,postfixButtons:fu,onButtonKeyDown:L,readonly:n,submitKeys:["Enter","Space","Tab"]}),bu=u=>{var p;l&&l(u),(p=a.current)==null||p.focus(),i(!1),a.current&&(a.current.value=A(u))},wu=()=>{Du(),Pu(()=>{B(I.Day),i(!1)})},Su=W([L,Bu,hu]);e.useEffect(()=>{var u;E&&((u=a.current)==null||u.focus())},[E]),e.useEffect(()=>{a.current&&document.activeElement!==a.current&&(a.current.value=A(t))},[A,t]);const Vu=e.useCallback(u=>{B(),d==null||d(u)},[d,B]),V=Yu({onFocusByClick:d,onFocusByKeyboard:Vu}),Iu=W([vu,V.onBlur,J]),qu=e.useCallback(u=>{O(),S&&u.stopPropagation()},[O,S]);return s.jsx(Ou,{className:Q,label:Z,labelTooltip:X,labelTooltipPlacement:uu,labelFor:c,required:w,caption:eu,hint:tu,disabled:o,readonly:n,showHintIcon:au,size:r,error:q,validationState:k,...Ju(_),children:s.jsx(Qu,{trigger:"click",triggerClassName:g.triggerClassName,widthStrategy:"auto",...n||o?{open:!1}:{open:T,onOpenChange:i},content:s.jsx("div",{className:g.calendarWrapper,"data-size":r,children:s.jsx(u4,{mode:m,size:r,value:t,showSeconds:C,onChangeValue:bu,buildCellProps:ou,navigationStartRef:R,onFocusLeave:wu,locale:y,"data-test-id":"field-date__calendar",fitToContainer:!1})}),children:s.jsx(Zu,{className:g.container,size:r,validationState:k,disabled:o,readonly:n,variant:Ku.SingleLine,focused:T,inputRef:a,postfix:yu,children:s.jsx(Xu,{ref:Lu(lu,a),"data-size":r,value:Eu||"",placeholder:Cu,onChange:Fu,onFocus:V.onFocus,onMouseDown:V.onMouseDown,onBlur:Iu,onKeyDown:Su,onClick:qu,disabled:o,readonly:n,tabIndex:gu,type:"text",id:c,name:F,"data-test-id":"field-date__input"})})})})});try{D.displayName="FieldDate",D.__docgenInfo={description:"",displayName:"FieldDate",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},open:{defaultValue:null,description:"Открыт date-picker",name:"open",required:!1,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"Колбек открытия пикера",name:"onOpenChange",required:!1,type:{name:"((value: boolean) => void)"}},value:{defaultValue:null,description:"Значение поля",name:"value",required:!1,type:{name:"Date"}},onChange:{defaultValue:null,description:"Колбек смены значения",name:"onChange",required:!1,type:{name:"((value: Date) => void)"}},showCopyButton:{defaultValue:null,description:"Отображение кнопки копирования",name:"showCopyButton",required:!1,type:{name:"boolean"}},onCopyButtonClick:{defaultValue:null,description:"Колбек клика по кнопке Копировать для поля",name:"onCopyButtonClick",required:!1,type:{name:"(() => void)"}},showClearButton:{defaultValue:{value:"true"},description:"Отображение кнопки Очистки поля",name:"showClearButton",required:!1,type:{name:"boolean"}},mode:{defaultValue:null,description:"",name:"mode",required:!0,type:{name:"enum",value:[{value:'"date"'},{value:'"date-time"'}]}},buildCellProps:{defaultValue:null,description:"Колбек установки свойств ячеек календаря. Вызывается на построение каждой ячейки. Принимает два параметра:\n<br> `Date` - дата ячейки\n<br> `ViewMode`:\n<br>  - `month` отображение месяца, каждая ячейка - 1 день\n<br>  - `year` отображение года, каждая ячейка - 1 месяц\n<br>  - `decade` отображение декады, каждая ячейка - 1 год\n<br><br> Колбек должен возвращать объект с полями, отвечающими за отключение и подкраску ячейки.",name:"buildCellProps",required:!1,type:{name:"(date: Date, viewMode: ViewMode) => { isDisabled?: boolean; isHoliday?: boolean } ;"}},id:{defaultValue:null,description:"Значение html-атрибута id",name:"id",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"Значение html-атрибута name",name:"name",required:!1,type:{name:"string"}},onFocus:{defaultValue:null,description:"Колбек обработки получения фокуса",name:"onFocus",required:!1,type:{name:"FocusEventHandler<HTMLInputElement>"}},onBlur:{defaultValue:null,description:"Колбек обработки потери фокуса",name:"onBlur",required:!1,type:{name:"FocusEventHandler<HTMLInputElement>"}},disabled:{defaultValue:{value:"false"},description:"Является ли поле деактивированным",name:"disabled",required:!1,type:{name:"boolean"}},readonly:{defaultValue:{value:"false"},description:"Является ли поле доступным только для чтения",name:"readonly",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},caption:{defaultValue:null,description:"Подпись справа от лейбла",name:"caption",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Лейбл",name:"label",required:!1,type:{name:"string"}},size:{defaultValue:{value:"s"},description:"Размер",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"l"'}]}},error:{defaultValue:null,description:"",name:"error",required:!1,type:{name:"string"}},labelTooltip:{defaultValue:null,description:"Всплывающая подсказка лейбла",name:"labelTooltip",required:!1,type:{name:"ReactNode"}},required:{defaultValue:{value:"false"},description:"Является ли поле обязательным",name:"required",required:!1,type:{name:"boolean"}},hint:{defaultValue:null,description:"Подсказка внизу",name:"hint",required:!1,type:{name:"string"}},showHintIcon:{defaultValue:null,description:"Отображать иконку подсказки",name:"showHintIcon",required:!1,type:{name:"boolean"}},validationState:{defaultValue:{value:"default"},description:"Состояние валидации",name:"validationState",required:!1,type:{name:"enum",value:[{value:'"error"'},{value:'"warning"'},{value:'"success"'},{value:'"default"'}]}},labelTooltipPlacement:{defaultValue:{value:"top"},description:"Расположение подсказки лейбла",name:"labelTooltipPlacement",required:!1,type:{name:"enum",value:[{value:'"left"'},{value:'"left-start"'},{value:'"left-end"'},{value:'"right"'},{value:'"right-start"'},{value:'"right-end"'},{value:'"top"'},{value:'"top-start"'},{value:'"top-end"'},{value:'"bottom"'},{value:'"bottom-start"'},{value:'"bottom-end"'}]}},showSeconds:{defaultValue:null,description:"",name:"showSeconds",required:!1,type:{name:"boolean"}}}}}catch{}const Ne={title:"Components/Fields/Field Date",component:D},o4=({size:c,modeBuildCellProps:F,...t})=>{var l;const o=e.useMemo(()=>t.dateValue?new Date(t.dateValue):void 0,[t.dateValue]),[n,v]=e.useState(o);e.useEffect(()=>{v(o)},[o]);const f=xu(F)||void 0,E=n&&((l=f==null?void 0:f(n,"month"))!=null&&l.isDisabled)?"error":void 0,b=E==="error"?"Дата не может быть выбрана":t.hint;return s.jsx("div",{className:Ru.wrapper,"data-size":c,children:s.jsx(D,{...t,showSeconds:"showSeconds"in t?t.showSeconds:void 0,size:c,value:n,buildCellProps:f,validationState:F==="none"?t.validationState:E,hint:F==="none"?t.hint:b,onChange:d=>{_u("onChange")(d),v(d)}})},t.mode)},h={render:o4,args:{mode:"date",showSeconds:!0,id:"date",readonly:!1,showCopyButton:!0,disabled:!1,label:"Label text",labelTooltip:"Tooltip description",required:!1,caption:"Caption",hint:"Hint text",size:"s",validationState:"default",showClearButton:!0,modeBuildCellProps:"none"},argTypes:{...ku,showSeconds:{if:{arg:"mode",eq:"date-time"}},prefixIcon:{table:{disable:!0}},modeBuildCellProps:{name:"[story] select buildCellProps operating mode",options:["for-tests","disable-past","none"],control:{type:"radio"}},dateValue:{name:"value",control:{type:"date"}}},parameters:{readme:{sidebar:[`Latest version: ${K.version}`,Tu,Nu]},packageName:K.name,design:{name:"Figma",type:"figma",url:"https://www.figma.com/file/jtGxAPvFJOMir7V0eQFukN/Snack-UI-Kit-1.1.0?node-id=402%3A202402&mode=design"}}};var Y,$,z;h.parameters={...h.parameters,docs:{...(Y=h.parameters)==null?void 0:Y.docs,source:{originalSource:`{
  render: Template,
  args: {
    mode: 'date',
    showSeconds: true,
    id: 'date',
    readonly: false,
    showCopyButton: true,
    disabled: false,
    label: 'Label text',
    labelTooltip: 'Tooltip description',
    required: false,
    caption: 'Caption',
    hint: 'Hint text',
    size: 's',
    validationState: 'default',
    showClearButton: true,
    modeBuildCellProps: 'none'
  },
  argTypes: {
    ...COMMON_ARG_TYPES,
    showSeconds: {
      if: {
        arg: 'mode',
        eq: 'date-time'
      }
    },
    prefixIcon: {
      table: {
        disable: true
      }
    },
    modeBuildCellProps: {
      name: '[story] select buildCellProps operating mode',
      options: ['for-tests', 'disable-past', 'none'],
      control: {
        type: 'radio'
      }
    },
    dateValue: {
      name: 'value',
      control: {
        type: 'date'
      }
    }
  },
  parameters: {
    readme: {
      sidebar: [\`Latest version: \${componentPackage.version}\`, componentReadme, componentChangelog]
    },
    packageName: componentPackage.name,
    design: {
      name: 'Figma',
      type: 'figma',
      url: 'https://www.figma.com/file/jtGxAPvFJOMir7V0eQFukN/Snack-UI-Kit-1.1.0?node-id=402%3A202402&mode=design'
    }
  }
}`,...(z=($=h.parameters)==null?void 0:$.docs)==null?void 0:z.source}}};export{Ne as default,h as fieldDate};
