import{j as r}from"./jsx-runtime-BTJTZTIL.js";import{c as Z}from"./index-DUmpqB7p.js";import{m as u4}from"./index-B7wZyJkK.js";import{r as a}from"./index-CJ_LmFaV.js";import{b as e4,u as t4,k as S,e as a4,a as l4,N as n4,S as r4,C as s4,F as o4,L as i4,s as d4,I as m}from"./hooks-Cv-w_Cx5.js";import{u as m4}from"./useValueControl-C51frgGe.js";import{i as c4}from"./isBrowser-C2N6XvuH.js";const p4="_hiddenBtn_izaix_1",E4={hiddenBtn:p4},V=a.forwardRef(({listRef:l,tabIndex:c},B)=>{const D=a.useCallback(p=>{var i;p.relatedTarget!==l.current&&((i=l.current)==null||i.focus()),p.preventDefault(),p.stopPropagation()},[l]);return r.jsx("button",{type:"button","aria-hidden":!0,ref:B,onKeyDown:e4,onFocus:D,className:E4.hiddenBtn,tabIndex:c})});try{V.displayName="HiddenTabButton",V.__docgenInfo={description:"",displayName:"HiddenTabButton",props:{listRef:{defaultValue:null,description:"",name:"listRef",required:!0,type:{name:"RefObject<HTMLElement>"}},tabIndex:{defaultValue:null,description:"",name:"tabIndex",required:!1,type:{name:"number"}}}}}catch{}const M=a.forwardRef(({items:l=[],search:c,pinBottom:B=[],pinTop:D=[],footerActiveElementsRefs:p,onKeyDown:i,tabIndex:q=0,className:H,collapse:k={},selection:s,contentRender:P,size:z="s",marker:O=!0,keyboardNavigationRef:w,hasListInFocusChain:F=!0,...R},K)=>{const h=a.useMemo(()=>!!c,[c]),[I=[],x]=m4(k),U=a.useCallback(u=>x(e=>e!=null&&e.includes(u)?e.filter(o=>o!==u):(e??[]).concat([u])),[x]),{searchItem:E,footerItems:A}=t4({footerActiveElementsRefs:p}),{flattenItems:X,focusFlattenItems:g,...f}=a.useMemo(()=>{const u=S({items:D,prefix:m.pinTop,parentId:m.default}),e=S({items:l,prefix:m.default,parentId:m.default}),o=S({items:B,prefix:m.pinBottom,parentId:m.default}),n={...u.flattenItems,...o.flattenItems,...e.flattenItems},d={...u.focusFlattenItems,...o.focusFlattenItems,...e.focusFlattenItems};return[...A,E].forEach(t=>{n[t.id]=t,d[t.id]={...t,originalId:t.id,items:[],key:t.id,allChildIds:[]}}),{items:e,pinTop:u,pinBottom:o,flattenItems:n,focusFlattenItems:d}},[l,D,B,E,A]),{ids:y,expandedIds:T}=a.useMemo(()=>{const{pinTop:u,items:e,pinBottom:o}=f;let n=[],d=[];return h&&n.push(E.id),[u,e,o].forEach(({focusFlattenItems:t,focusCloseChildIds:Y})=>{const L=a4({focusFlattenItems:t,focusCloseChildIds:Y,openCollapseItems:I,isSelectionMultiple:(s==null?void 0:s.mode)==="multiple"});n=n.concat(L.ids),d=d.concat(L.expandedIds)}),A.forEach(t=>{n.push(t.id)}),{ids:n,expandedIds:d}},[A,h,f,I,E.id,s==null?void 0:s.mode]),C=a.useRef(null),_=a.useRef(null),N=y[0],{handleListKeyDownFactory:v,activeItemId:j,resetActiveItemId:$,forceUpdateActiveItemId:G}=l4({mainRef:C,btnRef:_,focusFlattenItems:g,keyboardNavigationRef:w,hasListInFocusChain:F,firstItemId:N}),b=a.useCallback(u=>v(y,T)(u),[v,y,T]),J=c4()&&C.current===document.activeElement&&j===void 0,Q=u=>{i==null||i(u),b==null||b(u)},W=()=>{$()};return r.jsx(n4,{flattenItems:X,focusFlattenItems:g,contentRender:P,size:z,marker:O,firstItemId:N,virtualized:R.virtualized,children:r.jsx(r4,{...s,children:r.jsx(s4.Provider,{value:{openCollapseItems:I,toggleOpenCollapseItem:U},children:r.jsx(o4.Provider,{value:{activeItemId:j,handleListKeyDownFactory:v,forceUpdateActiveItemId:G},children:r.jsxs("div",{className:Z(d4.wrapper,H),"data-active":J||void 0,children:[r.jsx(i4,{...R,items:f.items.focusCloseChildIds,pinTop:f.pinTop.focusCloseChildIds,pinBottom:f.pinBottom.focusCloseChildIds,searchItem:E,ref:u4(K,C),onFocus:W,onKeyDown:Q,tabIndex:F?q:void 0,search:c,nested:!1}),F&&r.jsx(V,{ref:_,listRef:C,tabIndex:q})]})})})})})});try{M.displayName="List",M.__docgenInfo={description:"",displayName:"List",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"Основные элементы списка",name:"items",required:!0,type:{name:"Item[]"}},pinTop:{defaultValue:null,description:"Элементы списка, закрепленные сверху",name:"pinTop",required:!1,type:{name:"Item[]"}},pinBottom:{defaultValue:null,description:"Элементы списка, закрепленные снизу",name:"pinBottom",required:!1,type:{name:"Item[]"}},footer:{defaultValue:null,description:"Кастомизируемый элемент в конце списка",name:"footer",required:!1,type:{name:"ReactNode ;"}},footerActiveElementsRefs:{defaultValue:null,description:"Список ссылок на кастомные элементы, помещенные в специальную секцию внизу списка",name:"footerActiveElementsRefs",required:!1,type:{name:"RefObject<HTMLElement>[]"}},keyboardNavigationRef:{defaultValue:null,description:"Ссылка на управление навигацией листа с клавиатуры",name:"keyboardNavigationRef",required:!1,type:{name:"RefObject<{ focusItem(id: ItemId): void; }>"}},search:{defaultValue:null,description:"Настройки поисковой строки",name:"search",required:!1,type:{name:"SearchState"}},tabIndex:{defaultValue:{value:"0"},description:"Tab Index",name:"tabIndex",required:!1,type:{name:"number"}},collapse:{defaultValue:{value:"{}"},description:"Настройки раскрытия элементов",name:"collapse",required:!1,type:{name:"CollapseState"}},className:{defaultValue:null,description:"CSS-класс",name:"className",required:!1,type:{name:"string"}},loading:{defaultValue:null,description:"Флаг, отвещающий за состояние загрузки списка",name:"loading",required:!1,type:{name:"boolean"}},onKeyDown:{defaultValue:null,description:"Обработчик события по нажатию клавиш",name:"onKeyDown",required:!1,type:{name:"((e: KeyboardEvent<HTMLElement>) => void)"}},hasListInFocusChain:{defaultValue:{value:"true"},description:"Флаг, отвещающий за включение самого родительского контейнера листа в цепочку фокусирующихся элементов",name:"hasListInFocusChain",required:!1,type:{name:"boolean"}},scrollToSelectedItem:{defaultValue:null,description:"Флаг, отвещающий за прокручивание до выбранного элемента",name:"scrollToSelectedItem",required:!1,type:{name:"boolean"}},scrollContainerClassName:{defaultValue:null,description:"CSS-класс для scroll обертки основного списка айтемов",name:"scrollContainerClassName",required:!1,type:{name:"string"}},virtualized:{defaultValue:null,description:"Включить виртуализацию на компоненты списка. Рекомендуется если у вас от 1к элементов списка",name:"virtualized",required:!1,type:{name:"boolean"}},selection:{defaultValue:null,description:"",name:"selection",required:!1,type:{name:"SelectionMultipleState | SelectionSingleState"}},size:{defaultValue:{value:"s"},description:"Размер списка",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"l"'}]}},marker:{defaultValue:{value:"true"},description:"Отображать ли маркер у выбранного жлемента списка",name:"marker",required:!1,type:{name:"boolean"}},contentRender:{defaultValue:null,description:"Рендер функция основного контента айтема",name:"contentRender",required:!1,type:{name:"((props: ContentRenderProps) => ReactNode)"}},scroll:{defaultValue:null,description:"Включить ли скролл для основной части списка",name:"scroll",required:!1,type:{name:"boolean"}},scrollRef:{defaultValue:null,description:"Ссылка на элемент, обозначающий самый конец прокручиваемого списка",name:"scrollRef",required:!1,type:{name:"RefObject<HTMLElement>"}},scrollContainerRef:{defaultValue:null,description:"Ссылка на контейнер, который скроллится",name:"scrollContainerRef",required:!1,type:{name:"RefObject<HTMLElement>"}},untouchableScrollbars:{defaultValue:null,description:"Отключает возможность взаимодействовать со скролбарами мышью.",name:"untouchableScrollbars",required:!1,type:{name:"boolean"}},barHideStrategy:{defaultValue:null,description:"Управление скрытием скролл баров:\n<br> - `Never` - показывать всегда\n<br> - `Leave` - скрывать когда курсор покидает компонент\n<br> - `Scroll` - показывать только когда происходит скроллинг\n<br> - `Move` - показывать при движении курсора над компонентом",name:"barHideStrategy",required:!1,type:{name:"enum",value:[{value:'"move"'},{value:'"scroll"'},{value:'"never"'},{value:'"leave"'}]}},onScroll:{defaultValue:null,description:"Колбек на скролл прокручиваемого списка",name:"onScroll",required:!1,type:{name:"((event?: Event) => void)"}},dataFiltered:{defaultValue:null,description:"",name:"dataFiltered",required:!1,type:{name:"boolean"}},dataError:{defaultValue:null,description:"",name:"dataError",required:!1,type:{name:"boolean"}},noDataState:{defaultValue:null,description:"Экран при отстутствии данных",name:"noDataState",required:!1,type:{name:"EmptyStateProps"}},noResultsState:{defaultValue:null,description:"Экран при отстутствии результатов поиска или фильтров",name:"noResultsState",required:!1,type:{name:"EmptyStateProps"}},errorDataState:{defaultValue:null,description:"Экран при ошибке запроса",name:"errorDataState",required:!1,type:{name:"EmptyStateProps"}}}}}catch{}export{M as L};
