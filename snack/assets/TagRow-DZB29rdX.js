import{j as a}from"./jsx-runtime-BTJTZTIL.js";import{r as s}from"./index-CJ_LmFaV.js";import{S as N,A as G}from"./constants-BaREPXw5.js";import{c as j}from"./index-DUmpqB7p.js";import{T as Z}from"./Tag-CalHVeMA.js";import{e as C}from"./componentPropsProcessors-UJEZy8aQ.js";import{D as k}from"./Dropdown-uG1Hplv7.js";import{S as J}from"./Scroll-B3e6J9cA.js";const E={moreButton:"tag-row__more-button",visibleTagsWrapper:"tag-row__visible-row",droplistTagsWrapper:"tag-row__droplist-contents"},K="_tagWrapper_w2ppw_1",Q={tagWrapper:K};function U(e,u,t){return function(r,i){return a.jsx("div",{ref:t==null?void 0:t(r,i),className:Q.tagWrapper,children:a.jsx(Z,{size:e,onDelete:u==null?void 0:u(r),...r})},r.id??r.label)}}function m({items:e,size:u=N.Xs,onItemRemove:t,setTagRef:n}){const r=t?i=>()=>t(i.label):void 0;return a.jsx(a.Fragment,{children:e.map(U(u,r,n))})}try{m.displayName="TagList",m.__docgenInfo={description:"",displayName:"TagList",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TagRowItemInner[]"}},size:{defaultValue:{value:"xs"},description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'}]}},onItemRemove:{defaultValue:null,description:"",name:"onItemRemove",required:!1,type:{name:"((item: string) => void)"}},setTagRef:{defaultValue:null,description:"",name:"setTagRef",required:!1,type:{name:"SetTagRef"}}}}}catch{}const Y="_tagRowSimpleWrapper_1t549_1",ee={tagRowSimpleWrapper:Y};function y({items:e,size:u,onItemRemove:t,setTagRef:n,className:r,...i}){return a.jsx("div",{className:j(ee.tagRowSimpleWrapper,r),...C(i),"data-size":u,children:a.jsx(m,{items:e,size:u,onItemRemove:t,setTagRef:n})})}try{y.displayName="TagRowSimple",y.__docgenInfo={description:"",displayName:"TagRowSimple",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TagRowItemInner[]"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'}]}},onItemRemove:{defaultValue:null,description:"",name:"onItemRemove",required:!1,type:{name:"((item: string) => void)"}},setTagRef:{defaultValue:null,description:"",name:"setTagRef",required:!1,type:{name:"((item: TagRowItemInner) => Ref<HTMLDivElement>)"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}}}}}catch{}const ue="_button_gmohc_1",te="_tagRowDroplistContainer_gmohc_45",ae="_tagRowDroplistScroll_gmohc_56",re="_triggerClassName_gmohc_60",w={button:ue,tagRowDroplistContainer:te,tagRowDroplistScroll:ae,triggerClassName:re};function h({items:e,text:u="",size:t=N.Xs,buttonRef:n,onItemRemove:r}){return a.jsx(k,{placement:"bottom-end",trigger:"hoverAndFocusVisible",triggerClassName:w.triggerClassName,content:a.jsx("div",{className:w.tagRowDroplistContainer,"data-size":t,children:a.jsx(J,{className:w.tagRowDroplistScroll,size:"s",barHideStrategy:"move",children:a.jsx(y,{items:e,size:t,onItemRemove:r,"data-test-id":E.droplistTagsWrapper})})}),children:a.jsx("button",{type:"button",className:w.button,ref:n,"data-size":t,"data-test-id":E.moreButton,children:`${u}${e.length}`})})}try{h.displayName="TagMore",h.__docgenInfo={description:"",displayName:"TagMore",props:{items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TagRowItemInner[]"}},size:{defaultValue:{value:"xs"},description:"",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'}]}},text:{defaultValue:{value:""},description:"",name:"text",required:!1,type:{name:"string"}},buttonRef:{defaultValue:null,description:"",name:"buttonRef",required:!1,type:{name:"Ref<HTMLButtonElement>"}},onItemRemove:{defaultValue:null,description:"",name:"onItemRemove",required:!1,type:{name:"((item: string) => void)"}}}}}catch{}const A=e=>{const[u,t]=s.useState(0);return s.useEffect(()=>{if(!e)return;const n=new ResizeObserver(()=>{e.offsetWidth!==u&&t(e.offsetWidth)});return n.observe(e),()=>n.disconnect()},[e,u]),{width:u}},ne="_wrapper_1bq6d_1",se="_visibleRow_1bq6d_16",ie="_hiddenRow_1bq6d_28",oe="_hiddenMoreButton_1bq6d_44",T={wrapper:ne,visibleRow:se,hiddenRow:ie,hiddenMoreButton:oe},le=e=>{const u=e.current?getComputedStyle(e.current,null).getPropertyValue("gap"):"0px";return parseInt(u)};function de({items:e,rowLimit:u,size:t,moreButtonLabel:n="",className:r,onItemRemove:i,...F}){const[M,z]=s.useState([]),[D,L]=s.useState([]),v=s.useRef(null),B=s.useRef(null),H=s.useRef(null),[$,O]=s.useState(null),b=s.useRef(new Map),{width:f}=A(v.current),{width:P}=A($);function X(o,d){return l=>{d===0&&l&&O(l),l===null?b.current.delete(o):b.current.set(o,l)}}const x=le(v);return s.useEffect(()=>{var S;if(f<1)return;const o=[],d=[],l=((S=B.current)==null?void 0:S.offsetWidth)||0;let g=0,_=1,p=0;b.current.forEach((V,c)=>{const W=(V==null?void 0:V.offsetWidth)||0,R=g+W+x;if(_>u){d.push(c);return}if(_===u){if(R+l>f){_++,p=0,d.push(c);return}g=R,o.push(c),p++;return}if(R>f){g=p?W+x:0,_++,p=0,o.push(c);return}p++,g=R,o.push(c)}),z(o),L(d)},[e,u,f,i,x,P]),a.jsxs("div",{className:j(T.wrapper,r),...C(F),"data-size":t,children:[a.jsx("div",{className:T.hiddenRow,ref:v,"data-size":t,children:a.jsx(m,{items:e,size:t,onItemRemove:i,setTagRef:X})}),a.jsx("div",{className:T.hiddenMoreButton,ref:H,children:a.jsx(h,{items:e,text:n,size:t,buttonRef:B})}),a.jsxs("div",{className:T.visibleRow,"data-size":t,"data-test-id":E.visibleTagsWrapper,children:[a.jsx(m,{items:M,size:t,onItemRemove:i}),D.length>0&&a.jsx(h,{items:D,text:n,size:t,onItemRemove:i})]})]})}const q=s.memo(de);try{q.displayName="TagRowTruncated",q.__docgenInfo={description:"",displayName:"TagRowTruncated",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"TagRowItemInner[]"}},rowLimit:{defaultValue:null,description:"",name:"rowLimit",required:!0,type:{name:"number"}},moreButtonLabel:{defaultValue:null,description:"",name:"moreButtonLabel",required:!1,type:{name:"string"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'}]}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},onItemRemove:{defaultValue:null,description:"",name:"onItemRemove",required:!1,type:{name:"((item: string) => void)"}}}}}catch{}const pe=({appearance:e=G.Neutral,...u})=>({...u,appearance:e});function ce({items:e,rowLimit:u,size:t=N.Xs,...n}){const r=s.useMemo(()=>e.map(pe),[e]);return u?a.jsx(q,{items:r,rowLimit:u,size:t,...n}):a.jsx(y,{items:r,size:t,...n})}const I=s.memo(ce);try{I.displayName="TagRow",I.__docgenInfo={description:"",displayName:"TagRow",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"Массив тэгов",name:"items",required:!0,type:{name:"TagRowItem[]"}},rowLimit:{defaultValue:null,description:"Лимит количества рядов тэгов. При достижении лимита тэги скрываются под кнопкой. Отсутствие лимита или значение равное нулю отобразит весь список",name:"rowLimit",required:!1,type:{name:"number"}},size:{defaultValue:null,description:"Размер",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"xs"'}]}},moreButtonLabel:{defaultValue:null,description:"Текст кнопки, при наведении на которую отображается список скрытых тэгов",name:"moreButtonLabel",required:!1,type:{name:"string"}},className:{defaultValue:null,description:"CSS-класс",name:"className",required:!1,type:{name:"string"}},onItemRemove:{defaultValue:null,description:"Коллбэк на клик по удалению тэга",name:"onItemRemove",required:!1,type:{name:"((item: string) => void)"}}}}}catch{}export{I as T};
