import{j as A}from"./jsx-runtime-BTJTZTIL.js";import{r as c}from"./index-CJ_LmFaV.js";import{u as N}from"./PopoverPrivate-CnKgsFAm.js";function H(a){const s=(a==null?void 0:a.value.length)??0;a==null||a.setSelectionRange(s,s)}function V(a){a==null||a.setSelectionRange(0,a==null?void 0:a.value.length)}function I(a){setTimeout(a,0)}function R(a){return(a==null?void 0:a.selectionStart)===0}function M(a){var s;return(a==null?void 0:a.selectionStart)===((s=a==null?void 0:a.value)==null?void 0:s.length)}function B({inputRef:a,setInputFocus:s=()=>{var w;return(w=a.current)==null?void 0:w.focus()},postfixButtons:l,prefixButtons:n=[],onButtonKeyDown:L=()=>{},readonly:f,submitKeys:C}){const[w,P]=c.useState(0),i=N(L),m=c.useCallback(()=>n.map(()=>-1),[n]),[q,D]=c.useState(m),k=c.useCallback(()=>l.map(()=>-1),[l]),[S,F]=c.useState(k),y=c.useCallback((e,u)=>{const t=u==="ArrowLeft"?-1:1,d=r=>u==="ArrowLeft"?r>=0:r<n.length;for(let r=e+t;d(r);r+=t)if(n[r].active&&n[r].show)return r;return e},[n]),g=c.useCallback((e,u)=>{const t=u==="ArrowLeft"?-1:1,d=r=>u==="ArrowLeft"?r>=0:r<l.length;for(let r=e+t;d(r);r+=t)if(l[r].active&&l[r].show)return r;return e},[l]),o=c.useCallback(()=>{P(0),D(m),F(k)},[m,k]),T=c.useCallback(()=>{o(),s()},[o,s]),h=c.useCallback(e=>{var u,t;P(-1),D(d=>d.map((r,_)=>_===e?0:-1)),F(k),(u=n[e])!=null&&u.active&&((t=n[e].ref.current)==null||t.focus())},[k,n]),b=c.useCallback(e=>{var u,t;P(-1),D(m),F(d=>d.map((r,_)=>_===e?0:-1)),(u=l[e])!=null&&u.active&&((t=l[e].ref.current)==null||t.focus())},[m,l]),j=c.useCallback(e=>{if(o(),e.key==="ArrowRight"&&(f||M(a.current))){const u=g(-1,e.key);u>=0&&b(u)}if(e.key==="ArrowLeft"&&(f||R(a.current))){const u=y(n.length,e.key);u>=0&&h(u)}},[g,y,b,h,a,n.length,f,o]),v=c.useCallback(e=>u=>{if(u.key==="ArrowRight"){const t=y(e,u.key);e===t?(u.preventDefault(),T(),f&&I(()=>V(a.current))):h(t)}u.key==="ArrowLeft"&&e<=n.length-1&&h(y(e,u.key)),C.includes(u.key)&&I(()=>o()),i==null||i(u)},[i,n.length,y,h,T,a,f,o,C]),K=c.useCallback(e=>u=>{if(u.key==="ArrowLeft"){const t=g(e,u.key);e===t?(u.preventDefault(),T(),f&&I(()=>V(a.current))):b(t)}u.key==="ArrowRight"&&e<=l.length-1&&b(g(e,u.key)),C.includes(u.key)&&I(()=>o()),i==null||i(u)},[i,l.length,g,b,T,a,f,o,C]),E=c.useCallback(()=>{I(()=>o())},[o]);return{inputTabIndex:w,onInputKeyDown:j,setInitialTabIndices:o,prefixButtons:n.some(e=>e.show)?A.jsx(A.Fragment,{children:n.map((e,u)=>e.show?e.active?e.render({key:e.id,ref:e.ref,tabIndex:q[u],onKeyDown:v(u),onClick:E}):e.render({key:e.id}):null)}):void 0,postfixButtons:l.some(e=>e.show)?A.jsx(A.Fragment,{children:l.map((e,u)=>e.show?e.active?e.render({key:e.id,ref:e.ref,tabIndex:S[u],onKeyDown:K(u),onClick:E}):e.render({key:e.id}):null)}):void 0}}try{B.displayName="useButtonNavigation",B.__docgenInfo={description:"Позволяет использовать клавиатуру для навигации по элементам управления",displayName:"useButtonNavigation",props:{setInputFocus:{defaultValue:{value:"() => inputRef.current?.focus()"},description:"",name:"setInputFocus",required:!1,type:{name:"(() => void)"}},inputRef:{defaultValue:null,description:"",name:"inputRef",required:!0,type:{name:"RefObject<T>"}},postfixButtons:{defaultValue:null,description:"",name:"postfixButtons",required:!0,type:{name:"ButtonProps[]"}},prefixButtons:{defaultValue:{value:"[]"},description:"",name:"prefixButtons",required:!1,type:{name:"ButtonProps[]"}},onButtonKeyDown:{defaultValue:{value:"() => {}"},description:"",name:"onButtonKeyDown",required:!1,type:{name:"KeyboardEventHandler<HTMLButtonElement>"}},readonly:{defaultValue:null,description:"",name:"readonly",required:!0,type:{name:"boolean"}},submitKeys:{defaultValue:null,description:"",name:"submitKeys",required:!0,type:{name:"string[]"}}}}}catch{}export{H as m,I as r,B as u};
