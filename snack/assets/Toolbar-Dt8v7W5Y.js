import{j as e}from"./jsx-runtime-BTJTZTIL.js";import{c as I}from"./index-DUmpqB7p.js";import{r as m}from"./index-CJ_LmFaV.js";import{u as y}from"./index-JZGyZbA2.js";import{h as z,C as L}from"./ChipChoiceRow-Dm6BRtqr.js";import{u as j}from"./PopoverPrivate-CnKgsFAm.js";import{u as k}from"./useIsomorphicLayoutEffect-BAXQmlEq.js";import{M,F as P}from"./index-NU8U5csw.js";import{C as H}from"./Checkbox-uZV6WJ28.js";import{T as F}from"./Tooltip-BNp3usZT.js";import{B}from"./ButtonFunction-DkDZEdUd.js";import{D as O}from"./DropList-sYSbfSyD.js";import{U as $}from"./index-zbp_5bxn.js";import{u as G}from"./LocaleProvider-CyhbxqE1.js";import{T as U}from"./Tag-CalHVeMA.js";import{e as K}from"./componentPropsProcessors-UJEZy8aQ.js";import{f as J}from"./hooks-Cv-w_Cx5.js";function Q({parentContainerRef:u,resizingContainerRef:r=u,items:s,maxVisibleItems:t=1/0}){const c=o=>Math.min(t,o),[l,f]=m.useState(c(s.length)),[p,b]=m.useState(1/0),n=m.useRef(p),i=o=>{f(typeof o=="number"?c(o):d=>o(c(d)))},a=j(()=>{const o=u.current;o&&o.scrollWidth-o.offsetWidth>0&&s[l-1]&&i(x=>x-1)}),h=j(()=>{s[l]&&i(d=>d+1)}),A=j(({changedWidth:o,initialWidth:d})=>{o>d?l<t&&h():o<d&&a()});return m.useEffect(()=>{const o=()=>{a(),u.current&&b(u.current.scrollWidth)};return document.fonts.addEventListener("loadingdone",o),()=>document.fonts.removeEventListener("loadingdone",o)},[u,a]),m.useEffect(()=>{const o=r.current;if(o){const d=new ResizeObserver(x=>x.forEach(N=>{if(N.target===o){const[{inlineSize:T}]=N.contentBoxSize;b(Math.floor(T))}}));return d.observe(o),()=>d.disconnect()}},[r]),k(()=>{u.current&&A({initialWidth:u.current.scrollWidth,changedWidth:n.current})},[s,u,A]),k(()=>{A({initialWidth:n.current,changedWidth:p}),n.current=p},[p,A]),k(()=>{a()},[a,l]),{visibleItems:s.slice(0,l),hiddenItems:s.slice(l)}}const _={checkbox:"toolbar__checkbox",confirmAction:"toolbar__confirm-action",rejectAction:"toolbar__reject-action",deleteAction:"toolbar__delete-action",deactivateAction:"toolbar__deactivate-action",disabledAction:"toolbar__disabled-action",bulkActions:"toolbar__bulk-actions",moreBulkActionsButton:"toolbar__more-bulk-actions-button",refreshButton:"toolbar__refresh-button",search:"toolbar__search",filterButton:"toolbar__filter-button",filterRow:"toolbar__filter-row",moreActionsButton:"toolbar__more-actions-button",droplist:"toolbar__droplist",option:"toolbar__droplist-option",after:"toolbar__after"},W={Multiple:"multiple"},X="_bulkActionsWrapper_l7t4g_1",Y="_bulkActions_l7t4g_1",Z="_checkboxWrapper_l7t4g_20",w="_moreActionButton_l7t4g_39",R="_action_l7t4g_43",E={bulkActionsWrapper:X,bulkActions:Y,checkboxWrapper:Z,moreActionButton:w,action:R};function D({actions:u=[],checked:r,onCheck:s,indeterminate:t,selectionMode:c=W.Multiple,resizingContainerRef:l}){const f=m.useCallback(i=>{(i.key===" "||i.key==="Enter")&&(s==null||s())},[s]),p=m.useRef(null),{visibleItems:b,hiddenItems:n}=Q({items:u,resizingContainerRef:l,parentContainerRef:p,maxVisibleItems:3});return e.jsxs(e.Fragment,{children:[c===W.Multiple&&e.jsx("div",{className:E.checkboxWrapper,onClick:s,tabIndex:0,role:"checkbox","aria-checked":r,onKeyDown:f,"data-test-id":_.checkbox,children:e.jsx(H,{size:"s",checked:r,indeterminate:t,tabIndex:-1})}),(r||t)&&u.length>0&&e.jsxs("div",{className:E.bulkActionsWrapper,"data-test-id":_.bulkActions,ref:p,children:[e.jsx("div",{className:E.bulkActions,children:b.map(({label:i,icon:a,onClick:h,disabled:A,tooltip:o,"data-test-id":d})=>e.jsx(F,{tip:o,open:o?void 0:!1,placement:"top","data-test-id":`${d}-tooltip`,children:e.jsx(B,{className:E.action,fullWidth:!0,"data-test-id":d,iconPosition:"before",icon:e.jsx(a,{}),label:i,size:"m",onClick:h,disabled:A})},i))}),n.length>0&&e.jsx(O,{trigger:"clickAndFocusVisible",closeDroplistOnItemClick:!0,items:n.map(({label:i,icon:a,onClick:h,disabled:A,tooltip:o,"data-test-id":d})=>({id:i,content:{option:i},beforeContent:e.jsx(a,{}),onClick:h,disabled:A,itemWrapRender:x=>e.jsx(F,{tip:o,open:o?void 0:!1,placement:"right","data-test-id":`${d}-tooltip`,children:x}),"data-test-id":d})),children:e.jsx(B,{className:E.moreActionButton,size:"m",icon:e.jsx(M,{}),"data-test-id":_.moreBulkActionsButton})})]})]})}try{D.displayName="BulkActions",D.__docgenInfo={description:"",displayName:"BulkActions",props:{actions:{defaultValue:{value:"[]"},description:"Список массовых действий",name:"actions",required:!1,type:{name:"BulkAction[]"}},onCheck:{defaultValue:null,description:"Колбек смены значения чекбокса",name:"onCheck",required:!1,type:{name:"(() => void)"}},checked:{defaultValue:null,description:"Значение чекбокса",name:"checked",required:!1,type:{name:"boolean"}},indeterminate:{defaultValue:null,description:"Состояние частичного выбора",name:"indeterminate",required:!1,type:{name:"boolean"}},selectionMode:{defaultValue:{value:"multiple"},description:"Режим выбора",name:"selectionMode",required:!1,type:{name:"enum",value:[{value:'"single"'},{value:'"multiple"'}]}},resizingContainerRef:{defaultValue:null,description:"",name:"resizingContainerRef",required:!0,type:{name:"RefObject<HTMLDivElement>"}}}}}catch{}function C({open:u,onOpenChange:r,numberOfFilters:s}){const{t}=G("Toolbar");return e.jsx(F,{tip:t(u?"hideFilters":"showFilters"),children:e.jsx(B,{size:"m",icon:e.jsx(P,{}),onClick:()=>r(!u),counter:s?{value:s,appearance:"neutral"}:void 0,"data-test-id":_.filterButton})})}try{C.displayName="FilterButton",C.__docgenInfo={description:"",displayName:"FilterButton",props:{open:{defaultValue:null,description:"",name:"open",required:!0,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"",name:"onOpenChange",required:!0,type:{name:"(open: boolean) => void"}},numberOfFilters:{defaultValue:null,description:"",name:"numberOfFilters",required:!1,type:{name:"number"}}}}}catch{}const uu="_separatorWrapper_17f39_1",eu="_separator_17f39_1",q={separatorWrapper:uu,separator:eu};function v(){return e.jsx("div",{className:q.separatorWrapper,children:e.jsx("div",{className:q.separator})})}function V({moreActions:u}){const[r,s]=m.useState(!1);return e.jsx(O,{trigger:"clickAndFocusVisible",open:r,"data-test-id":_.droplist,onOpenChange:s,placement:"bottom-end",scroll:!0,size:"s",items:u.map(t=>({onClick:c=>{var l;(l=t.onClick)==null||l.call(t,c),s(!1),c.stopPropagation()},disabled:t.disabled,content:t.content,beforeContent:t.icon,afterContent:t.tagLabel?e.jsx(U,{label:t.tagLabel}):void 0,"data-test-id":_.option})),children:e.jsx(B,{icon:e.jsx(M,{size:24}),size:"m","data-test-id":_.moreActionsButton})})}try{V.displayName="MoreActions",V.__docgenInfo={description:"",displayName:"MoreActions",props:{moreActions:{defaultValue:null,description:"",name:"moreActions",required:!0,type:{name:"Action[]"}}}}}catch{}function tu({onCheck:u,checked:r,indeterminate:s,bulkActions:t=[],selectionMode:c}){return{onCheck:u,checked:r,indeterminate:s,actions:t,selectionMode:c}}function nu(u){return"selectionMode"in u&&u.selectionMode==="multiple"}const ou="_containerWrapper_ps8lc_5",su="_container_ps8lc_5",au="_search_ps8lc_34",iu="_updateButton_ps8lc_49",ru="_beforeSearch_ps8lc_61",lu="_flexRow_ps8lc_68",cu="_actions_ps8lc_77",du="_list_ps8lc_82",g={containerWrapper:ou,container:su,search:au,updateButton:iu,beforeSearch:ru,flexRow:lu,actions:cu,list:du};function pu({filterRow:u}){const[r,s]=y(u==null?void 0:u.open,!1,n=>{var a;const i=typeof n=="function"?n(r):n;(a=u==null?void 0:u.onOpenChange)==null||a.call(u,i)}),[t,c]=y(u==null?void 0:u.value,(u==null?void 0:u.defaultValue)??{},n=>{var a;const i=typeof n=="function"?n(t):n;(a=u==null?void 0:u.onChange)==null||a.call(u,i)}),[l,f]=y(u==null?void 0:u.visibleFilters,Object.keys(t),n=>{var a;const i=typeof n=="function"?n(l):n;(a=u==null?void 0:u.onVisibleFiltersChange)==null||a.call(u,i)}),p=m.useMemo(()=>((u==null?void 0:u.filters)??[]).map(n=>["single","multiple"].includes(n.type)?{...n,dropDownClassName:I(n.dropDownClassName,g.list)}:n),[u==null?void 0:u.filters]),b=m.useMemo(()=>Object.keys(t).reduce((n,i)=>n+Number(z(t[i])),0),[t]);return{filterButton:u?{open:r,onOpenChange:s,numberOfFilters:b}:void 0,filterRow:r&&u?{...u,open:void 0,onOpenChange:void 0,filters:p,value:t,onChange:c,visibleFilters:l,onVisibleFiltersChange:f}:void 0}}function S({className:u,after:r,outline:s,moreActions:t,onRefresh:c,search:l,filterRow:f,...p}){const b=nu(p),n=!!(b||c),i=m.useRef(null),{filterButton:a,filterRow:h}=pu({filterRow:f});return e.jsxs("div",{className:g.containerWrapper,...K(p),children:[e.jsxs("div",{className:I(g.container,u),"data-outline":s||void 0,ref:i,children:[n&&e.jsxs("div",{className:g.beforeSearch,children:[b&&e.jsxs(e.Fragment,{children:[e.jsx(D,{...tu(p),resizingContainerRef:i}),e.jsx(v,{})]}),c&&e.jsxs(e.Fragment,{children:[e.jsx(B,{icon:e.jsx($,{}),size:"m",className:g.updateButton,onClick:c,"data-test-id":_.refreshButton}),e.jsx(v,{})]})]}),l&&e.jsx(J,{...l,className:g.search,size:"m","data-test-id":_.search}),(t||r||a)&&e.jsxs("div",{className:g.flexRow,"data-align-right":!l&&!n||void 0,children:[r&&e.jsxs(e.Fragment,{children:[(l||n)&&e.jsx(v,{}),e.jsx("div",{"data-test-id":_.after,className:g.actions,children:r})]}),(t||a)&&e.jsx(v,{}),a&&e.jsx(C,{...a}),t&&e.jsx(V,{moreActions:t})]})]}),h&&e.jsx(L,{...h,size:"xs","data-test-id":_.filterRow})]})}try{S.displayName="Toolbar",S.__docgenInfo={description:"",displayName:"Toolbar",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},search:{defaultValue:null,description:`Параметры отвечают за строку поиска <br>
<strong>value</strong>: Значение строки поиска <br>
<strong>onChange</strong>: Колбэк смены значения <br>
<strong>onSubmit</strong>: Колбэк на подтверждение поиска по строке
<strong>placeholder</strong>: Плейсхолдер <br>
<strong>loading</strong>: Состояние загрузки <br>`,name:"search",required:!1,type:{name:"{ value: string; onChange(value: string): void; onSubmit?(value: string): void; placeholder?: string; loading?: boolean; } | undefined"}},className:{defaultValue:null,description:"Класснейм",name:"className",required:!1,type:{name:"string"}},outline:{defaultValue:null,description:"Внешний бордер",name:"outline",required:!1,type:{name:"boolean"}},selectionMode:{defaultValue:{value:"'multiple'"},description:"Режим выбора",name:"selectionMode",required:!1,type:{name:"enum",value:[{value:'"single"'},{value:'"multiple"'}]}},checked:{defaultValue:null,description:"Значение чекбокса",name:"checked",required:!1,type:{name:"boolean"}},onCheck:{defaultValue:null,description:"Колбек смены значения чекбокса",name:"onCheck",required:!1,type:{name:"(() => void)"}},indeterminate:{defaultValue:null,description:"Состояние частичного выбора",name:"indeterminate",required:!1,type:{name:"boolean"}},bulkActions:{defaultValue:null,description:"Список массовых действий",name:"bulkActions",required:!1,type:{name:"BulkAction[]"}},after:{defaultValue:null,description:"Дополнительный слот в конце тулбара",name:"after",required:!1,type:{name:"ReactNode"}},onRefresh:{defaultValue:null,description:"Колбек обновления",name:"onRefresh",required:!1,type:{name:"(() => void)"}},moreActions:{defaultValue:null,description:"Элементы выпадающего списка кнопки с действиями",name:"moreActions",required:!1,type:{name:"Action[]"}},filterRow:{defaultValue:null,description:"",name:"filterRow",required:!1,type:{name:"FilterRow<TState>"}}}}}catch{}export{_ as T,S as a};
