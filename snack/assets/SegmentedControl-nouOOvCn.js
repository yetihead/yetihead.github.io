import{j as m}from"./jsx-runtime-BTJTZTIL.js";import{c as x}from"./index-DUmpqB7p.js";import{r as a}from"./index-CJ_LmFaV.js";import{u as B}from"./index-JZGyZbA2.js";import{T as R}from"./TruncateString-BPmgFnBz.js";import{e as k,a as T}from"./componentPropsProcessors-UJEZy8aQ.js";const j={Auto:"auto"},w=(l,n,o)=>o==="xs"?"label-only":l&&n?"icon-before":n?"label-only":"icon-only",F="_segment_b6cgn_1",H="_icon_b6cgn_117",I="_label_b6cgn_123",E={segment:F,icon:H,label:I};function D({size:l,label:n,value:o,selected:s,onClick:p,disabled:c,icon:i,focusable:r,onGetFocusable:d,onSelectionUpdated:f,renderWrapSegment:e}){const u=a.useRef(null);a.useEffect(()=>{r&&(d==null||d(u.current))},[r,d]),a.useEffect(()=>{s&&u.current&&f(u.current)},[s,u,f]);const v=m.jsxs("button",{ref:u,"data-test-id":`section-${o}`,"data-active":s||void 0,"data-disabled":c||void 0,"data-layout":w(i,n,l),className:x(E.segment),onClick:p,"data-size":l,disabled:c,tabIndex:r?0:-1,"aria-checked":s,role:"radio",type:"button",children:[l!=="xs"&&i&&m.jsx("div",{className:E.icon,children:i}),n&&m.jsx(R,{className:E.label,"data-size":l,text:n})]});return e?e(v):v}try{D.displayName="Segment",D.__docgenInfo={description:"",displayName:"Segment",props:{value:{defaultValue:null,description:"Идентификатор сегмента.",name:"value",required:!0,type:{name:"IdType"}},label:{defaultValue:null,description:"Текстовый заголовок сегмента.",name:"label",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Состояние активности сегмента.",name:"disabled",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Иконка сегмента.",name:"icon",required:!1,type:{name:"ReactNode"}},renderWrapSegment:{defaultValue:null,description:"Render-обертка над сегментом.",name:"renderWrapSegment",required:!1,type:{name:"((segment: ReactNode) => ReactNode)"}},size:{defaultValue:null,description:"",name:"size",required:!0,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"xs"'},{value:'"l"'}]}},selected:{defaultValue:null,description:"",name:"selected",required:!0,type:{name:"boolean"}},onClick:{defaultValue:null,description:"",name:"onClick",required:!0,type:{name:"() => void"}},focusable:{defaultValue:null,description:"",name:"focusable",required:!1,type:{name:"boolean"}},onGetFocusable:{defaultValue:null,description:"",name:"onGetFocusable",required:!1,type:{name:"((ref: HTMLButtonElement | null) => void)"}},onSelectionUpdated:{defaultValue:null,description:"",name:"onSelectionUpdated",required:!0,type:{name:"(element: HTMLButtonElement) => void"}}}}}catch{}function L({selected:l,items:n}){const[o,s]=a.useState(l),[p,c]=a.useState(!1),{prev:i,next:r}=a.useMemo(()=>n.reduce((e,u)=>(e._isNextSearching&&!e.next&&(e.next=u.disabled?e.next:u.value),o===u.value&&(e._isNextSearching=!0),e._isNextSearching||(e.prev=u.disabled?e.prev:u.value),e),{_isNextSearching:!1}),[o,n]),d=a.useCallback(e=>{switch(e.key){case"ArrowLeft":{i&&(c(!0),s(i));return}case"ArrowRight":{r&&(c(!0),s(r));return}default:return}},[r,i]),f=a.useCallback(e=>{c(u=>(u&&(e==null||e.focus()),!1))},[]);return{onKeyDown:d,focusableSegmentValue:o,onGetFocusable:f}}const P="_container_k8ct1_1",M="_segmentHolder_k8ct1_48",z="_selection_k8ct1_59",_={container:P,segmentHolder:M,selection:z};function V({defaultValue:l,size:n="m",className:o,onChange:s,items:p,value:c,outline:i,width:r=j.Auto,name:d,...f}){const[e,u]=B(c,l,s),{focusableSegmentValue:v,onGetFocusable:b,onKeyDown:h}=L({selected:e,items:p}),y=a.useRef(null),C=a.useRef(),[q,N]=a.useState(),g=a.useCallback((t=C.current)=>{t&&(C.current=t,setTimeout(()=>{N({top:t.offsetTop,left:t.offsetLeft,width:t.offsetWidth,height:t.offsetHeight})}))},[]);a.useEffect(()=>{if(!y.current)return;const t=new ResizeObserver(()=>g());t.observe(y.current);const S=new MutationObserver(()=>g());return S.observe(y.current,{childList:!0}),()=>{t.disconnect(),S.disconnect()}},[g]);const A=a.useMemo(()=>p.map(t=>m.jsx("div",{className:_.segmentHolder,"data-width":r,children:m.jsx(D,{...t,size:n,onGetFocusable:b,selected:e===t.value,onClick:()=>u(t.value),focusable:v===t.value,onSelectionUpdated:g})},t.value)),[p,r,n,b,e,v,g,u]);return m.jsxs("div",{ref:y,"data-size":n,onKeyDown:h,className:x(_.container,o),role:"radiogroup","data-outline":i||void 0,"data-width":r,...T(f),...k(f),children:[d&&m.jsx("input",{type:"hidden",value:e,name:d}),m.jsx("div",{"data-size":n,style:q,className:_.selection,"aria-hidden":!0}),A]})}try{V.displayName="SegmentedControl",V.__docgenInfo={description:"SegmentedControl",displayName:"SegmentedControl",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},items:{defaultValue:null,description:"Набор сегментов.",name:"items",required:!0,type:{name:"Segment<Value>[]"}},value:{defaultValue:null,description:"Value выбранного сегмента.",name:"value",required:!1,type:{name:"IdType"}},defaultValue:{defaultValue:null,description:"ID выбранного по умолчанию сегмента. (в uncontrolled режиме)",name:"defaultValue",required:!1,type:{name:"IdType"}},onChange:{defaultValue:null,description:"Колбек смены выбранного сегмента.",name:"onChange",required:!1,type:{name:"((value: Value) => void)"}},className:{defaultValue:null,description:"CSS-класс контейнера.",name:"className",required:!1,type:{name:"string"}},size:{defaultValue:{value:"m"},description:"Размер компонента.",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"xs"'},{value:'"l"'}]}},outline:{defaultValue:null,description:"Обводка",name:"outline",required:!1,type:{name:"boolean"}},width:{defaultValue:{value:"auto"},description:"Управление шириной компонента.",name:"width",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"full"'}]}},name:{defaultValue:null,description:"Имя поля",name:"name",required:!1,type:{name:"string"}}}}}catch{}export{V as S};
