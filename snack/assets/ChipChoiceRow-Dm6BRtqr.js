import{j as l}from"./jsx-runtime-BTJTZTIL.js";import{c as u4}from"./index-DUmpqB7p.js";import{r}from"./index-CJ_LmFaV.js";import{u as M}from"./index-JZGyZbA2.js";import{S as O,b as v}from"./constants-BIigMBdG.js";import{C as d,b as s}from"./index-DT_qDkzI.js";import{P as e4}from"./index-CwHIobxP.js";import{C as t4}from"./index-BQAaeyfQ.js";import{u as n4}from"./LocaleProvider-CyhbxqE1.js";import{e as a4}from"./componentPropsProcessors-UJEZy8aQ.js";import{D as l4}from"./Divider-C1X9zrkx.js";import{T as o4}from"./Tooltip-BNp3usZT.js";import{D as r4}from"./DropList-sYSbfSyD.js";import{B as w}from"./ButtonFunction-DkDZEdUd.js";const i4={[s.Single]:d.Single,[s.Multiple]:d.Multiple,[s.Date]:d.Date,[s.DateTime]:d.Date,[s.Time]:d.Time,[s.DateRange]:d.DateRange,[s.Custom]:d.Custom};function V(t){const n=i4[t.type];return l.jsx(n,{...t})}try{V.displayName="ForwardedChipChoice",V.__docgenInfo={description:"",displayName:"ForwardedChipChoice",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},type:{defaultValue:null,description:"",name:"type",required:!0,type:{name:"enum",value:[{value:'"single"'},{value:'"multiple"'},{value:'"date"'},{value:'"time"'},{value:'"date-time"'},{value:'"custom"'},{value:'"date-range"'}]}},"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},label:{defaultValue:null,description:"Лейбл",name:"label",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"Деактивирован ли компонент",name:"disabled",required:!1,type:{name:"boolean"}},loading:{defaultValue:null,description:`Состояние загрузки
Флаг, отвещающий за состояние загрузки списка`,name:"loading",required:!1,type:{name:"boolean"}},icon:{defaultValue:null,description:"Иконка",name:"icon",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},className:{defaultValue:null,description:"CSS-класс",name:"className",required:!1,type:{name:"string"}},tabIndex:{defaultValue:null,description:"HTML tab index",name:"tabIndex",required:!1,type:{name:"number"}},truncateVariant:{defaultValue:null,description:`Вариант обрезания лейбла
Вариант обрезания значения`,name:"truncateVariant",required:!1,type:{name:"enum",value:[{value:'"middle"'},{value:'"end"'}]}},size:{defaultValue:null,description:"Размер",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"xs"'},{value:'"l"'}]}},onClick:{defaultValue:null,description:"Колбек обработки клика",name:"onClick",required:!1,type:{name:"MouseEventHandler<HTMLButtonElement | HTMLDivElement>"}},disableFuzzySearch:{defaultValue:{value:"false"},description:"Отключает Fuzzy Search. Иногда в дроплисте могут быть различные айдишники - нам важно искать их без Fuzzy Search",name:"disableFuzzySearch",required:!1,type:{name:"boolean"}},onClearButtonClick:{defaultValue:null,description:"Колбек для клика по кнопке очистки",name:"onClearButtonClick",required:!1,type:{name:"MouseEventHandler<HTMLButtonElement>"}},placement:{defaultValue:null,description:"Расположение выпадающего меню",name:"placement",required:!1,type:{name:"enum",value:[{value:'"left"'},{value:'"left-start"'},{value:'"left-end"'},{value:'"right"'},{value:'"right-start"'},{value:'"right-end"'},{value:'"top"'},{value:'"top-start"'},{value:'"top-end"'},{value:'"bottom"'},{value:'"bottom-start"'},{value:'"bottom-end"'}]}},widthStrategy:{defaultValue:{value:"gte"},description:"Стратегия управления шириной контейнера поповера\n<br> - `auto` - соответствует ширине контента,\n<br> - `gte` - Great Than or Equal, равен ширине таргета или больше ее, если контент в поповере шире,\n<br> - `eq` - Equal, строго равен ширине таргета.",name:"widthStrategy",required:!1,type:{name:"enum",value:[{value:'"auto"'},{value:'"gte"'},{value:'"eq"'}]}},dropDownClassName:{defaultValue:null,description:"",name:"dropDownClassName",required:!1,type:{name:"string"}},open:{defaultValue:null,description:"Управляет состоянием показан/не показан.",name:"open",required:!1,type:{name:"boolean"}},onOpenChange:{defaultValue:null,description:"Колбек отображения компонента. Срабатывает при изменении состояния open.",name:"onOpenChange",required:!1,type:{name:"((isOpen: boolean) => void)"}},options:{defaultValue:null,description:"Массив опций",name:"options",required:!0,type:{name:"FilterOption<ContentRenderProps>[]"}},contentRender:{defaultValue:null,description:"",name:"contentRender",required:!1,type:{name:"((option: { label: ItemId; value?: ItemId; contentRenderProps?: ContentRenderProps; }) => ReactNode) | undefined"}},filterFn:{defaultValue:null,description:"",name:"filterFn",required:!1,type:{name:"((option: { label: ItemId; value?: ItemId; contentRenderProps?: ContentRenderProps; }) => boolean) | undefined"}},searchable:{defaultValue:null,description:"",name:"searchable",required:!1,type:{name:"boolean"}},autoApply:{defaultValue:null,description:"Флаг, отвечающий за применение выбранного значения по умолчанию",name:"autoApply",required:!1,type:{name:"boolean"}},onApprove:{defaultValue:null,description:"Колбек основной кнопки",name:"onApprove",required:!1,type:{name:"(() => void)"}},onCancel:{defaultValue:null,description:"Колбек кнопки отмены",name:"onCancel",required:!1,type:{name:"(() => void)"}},footer:{defaultValue:null,description:"Кастомизируемый элемент в конце списка",name:"footer",required:!1,type:{name:"ReactNode ;"}},footerActiveElementsRefs:{defaultValue:null,description:"Список ссылок на кастомные элементы, помещенные в специальную секцию внизу списка",name:"footerActiveElementsRefs",required:!1,type:{name:"RefObject<HTMLElement>[]"}},scrollToSelectedItem:{defaultValue:null,description:"Флаг, отвещающий за прокручивание до выбранного элемента",name:"scrollToSelectedItem",required:!1,type:{name:"boolean"}},virtualized:{defaultValue:null,description:"Включить виртуализацию на компоненты списка. Рекомендуется если у вас от 1к элементов списка",name:"virtualized",required:!1,type:{name:"boolean"}},selection:{defaultValue:null,description:"",name:"selection",required:!1,type:{name:"SelectionMultipleState | SelectionSingleState"}},scrollRef:{defaultValue:null,description:"Ссылка на элемент, обозначающий самый конец прокручиваемого списка",name:"scrollRef",required:!1,type:{name:"RefObject<HTMLElement>"}},scrollContainerRef:{defaultValue:null,description:"Ссылка на контейнер, который скроллится",name:"scrollContainerRef",required:!1,type:{name:"RefObject<HTMLElement>"}},dataFiltered:{defaultValue:null,description:"",name:"dataFiltered",required:!1,type:{name:"boolean"}},dataError:{defaultValue:null,description:"",name:"dataError",required:!1,type:{name:"boolean"}},noDataState:{defaultValue:null,description:"Экран при отстутствии данных",name:"noDataState",required:!1,type:{name:"EmptyStateProps"}},noResultsState:{defaultValue:null,description:"Экран при отстутствии результатов поиска или фильтров",name:"noResultsState",required:!1,type:{name:"EmptyStateProps"}},errorDataState:{defaultValue:null,description:"Экран при ошибке запроса",name:"errorDataState",required:!1,type:{name:"EmptyStateProps"}},defaultValue:{defaultValue:null,description:`Начальное состояние
Значение компонента по-умолчанию
Значение по-умолчанию для uncontrolled.
Значение компонента по умолчанию`,name:"defaultValue",required:!1,type:{name:"ItemId | Date | Range | TimeValue | ItemId[]"}},onChange:{defaultValue:null,description:`Controlled обработчик измения состояния
Колбек смены значения`,name:"onChange",required:!1,type:{name:"((value: Date) => void) | ((value: any) => void) | ((value: Range) => void) | OnChangeHandler<any> | ((value: TimeValue) => void)"}},value:{defaultValue:null,description:`Controlled состояние
Значение компонента
Выбранное значение.
Фактическое значение. Используется для отображения кнопки очистки, если свойство <strong>showClearButton=true</strong>`,name:"value",required:!1,type:{name:"any"}},valueRender:{defaultValue:null,description:`Колбек формирующий отображение выбранного значения. Принимает выбранное значение. По умолчанию для отображения используется FilterOption.label
Колбек формирующий строковое представление выбранного значения. Принимает выбранное значение
Колбек формирующий строковое представление выбранного значения. Принимает массив выбранных значений
Отображаемое значение`,name:"valueRender",required:!1,type:{name:"((value?: Date) => ReactNode) | ((value: any) => ReactNode) | ((value?: Range) => ReactNode) | ((option?: BaseOption<ContentRenderProps> | undefined) => ReactNode) | ((value?: TimeValue | undefined) => ReactNode) | ((option?: BaseOption<...>[] | undefined) => ReactNode) | undefined"}},mode:{defaultValue:null,description:"",name:"mode",required:!1,type:{name:"enum",value:[{value:'"date"'},{value:'"date-time"'},{value:'"month"'}]}},buildCalendarCellProps:{defaultValue:null,description:"Колбек свойств для управления ячейками календаря",name:"buildCalendarCellProps",required:!1,type:{name:"BuildCellPropsFunction"}},showSeconds:{defaultValue:null,description:"Показывать ли секунды",name:"showSeconds",required:!1,type:{name:"boolean"}},content:{defaultValue:null,description:`Контент выпадающего меню
<br>
<br> Принимает <strong>ReactNode</strong>
<br> Или функцию с аргументами:
<br> <strong>handleDroplistItemKeyDown</strong>: Обработчик нажатия клавиши на элемент выпадающего меню
<br> <strong>closeDroplist</strong>: Метод для закрытия выпадающего меню`,name:"content",required:!1,type:{name:"((props: CustomContentRenderProps<any>) => ReactNode)"}}}}}catch{}const p={Xs:"xs",S:"s",M:"m"},H={[p.Xs]:O.Xs,[p.S]:O.S,[p.M]:O.M},z={[p.Xs]:"xs",[p.S]:"s",[p.M]:"m"};function R4(t){return Array.isArray(t)?t.length>0&&Object.values(t).some(Boolean):t&&typeof t=="object"?Object.values(t).some(Boolean)||t instanceof Date:!!t}function b(t,n){if(Array.isArray(t))return Array.isArray(n)?t===n?!0:t.length!==n.length?!1:t.every((c,E)=>b(c,n[E])):!1;if(t&&typeof t=="object"){if(!n||typeof n!="object")return!1;if(t===n)return!0;if(t instanceof Date)return n instanceof Date?t.valueOf()===n.valueOf():!1;const c=Object.keys(t),E=Object.keys(n);return c.length!==E.length?!1:c.every(f=>b(t[f],n[f]))}return t===n}const d4="_chipChoiceRow_1go7c_1",s4="_pinnedItems_1go7c_8",p4="_controlWrapper_1go7c_15",c4="_divider_1go7c_21",E4="_addButtonWrapper_1go7c_26",D={chipChoiceRow:d4,pinnedItems:s4,controlWrapper:p4,divider:c4,addButtonWrapper:E4};function k({filters:t,onChange:n,showClearButton:c=!0,showAddButton:E=!0,className:f,value:L,defaultValue:I,size:C=p.S,visibleFilters:W,onVisibleFiltersChange:g,...Z}){const{t:q}=n4("Chips"),m=r.useMemo(()=>I??{},[I]),[i,B]=M(L,m,u=>{const e=typeof u=="function"?u(i):u;n==null||n(e)}),[o,F]=M(W,Object.keys(i),u=>{const e=typeof u=="function"?u(o):u;g==null||g(e)}),[X,G]=r.useState(""),[U,P]=r.useState(!1),T=(u,e)=>{B(a=>({...a,[u]:e}))},R=r.useCallback(u=>e=>{G(e?u:"")},[]),Y=()=>{const u=t.reduce((e,a)=>a.pinned?{...e,[a.id]:m[a.id]}:e,{});B(u),F([])},{pinnedFilters:A,nonPinnedFilters:y}=r.useMemo(()=>t.reduce((u,e)=>(e.pinned?u.pinnedFilters.push(e):u.nonPinnedFilters.push(e),u),{pinnedFilters:[],nonPinnedFilters:[]}),[t]),h=r.useMemo(()=>o.reduce((u,e)=>{const a=y.find(S=>S.id===e);return a&&u.push(a),u},[]),[o,y]),$=r.useMemo(()=>h.length>0||A.some(u=>!b(i[u.id],m[u.id])),[m,A,i,h.length]),J=u=>{const e=m[u];if(!b(i[u],e))return()=>B(a=>({...a,[u]:e}))},K=u=>()=>{F(e=>e==null?void 0:e.filter(a=>u!==a)),B(e=>({...e,[u]:void 0}))},N=r.useMemo(()=>y.reduce((u,e,a)=>(o.includes(e.id)||u.push({id:e.id,content:{option:e.label??e.id},onClick:()=>{F(function(S){return[...S??[],e.id]}),P(!1)},"data-test-id":`${v.addButtonOption}-${e["data-test-id"]??a}`}),u),[]),[o,y,F]),_=N.length>0,j=r.useRef(o);r.useEffect(()=>{const u=j.current;if(o.length>u.length){const e=o.find(a=>!u.includes(a));e&&R(e)(!0)}j.current=o},[o,R]);const x=c&&$,Q=E||x||h.length>0;return l.jsxs("div",{className:u4(D.chipChoiceRow,f),...a4(Z),children:[A.length>0&&l.jsxs("div",{className:D.pinnedItems,children:[A.map(u=>l.jsx(V,{...u,value:i[u.id],size:H[C],onChange:e=>T(u.id,e),onClearButtonClick:J(u.id)},u.id)),Q&&l.jsx(l4,{orientation:"vertical",className:D.divider})]}),h.map(u=>l.jsx(V,{...u,value:i[u.id],size:H[C],onChange:e=>T(u.id,e),onClearButtonClick:K(u.id),open:X===u.id,onOpenChange:R(u.id)},u.id)),l.jsxs("div",{className:D.controlWrapper,children:[E&&l.jsx(o4,{tip:q("addButtonDisabledTip"),open:_?!1:void 0,placement:"bottom","data-test-id":v.addButtonTooltip,children:l.jsx(r4,{open:_&&U,onOpenChange:P,items:N,triggerClassName:D.addButtonWrapper,trigger:"clickAndFocusVisible",children:l.jsx(w,{disabled:!_,label:q("add"),icon:l.jsx(e4,{}),iconPosition:"before",size:z[C],"data-test-id":v.addButton})})}),x&&l.jsx(w,{onClick:Y,label:q("clear"),icon:l.jsx(t4,{}),iconPosition:"before",size:z[C],"data-test-id":v.clearButton})]})]})}try{k.displayName="ChipChoiceRow",k.__docgenInfo={description:"",displayName:"ChipChoiceRow",props:{"data-test-id":{defaultValue:null,description:"",name:"data-test-id",required:!1,type:{name:"string"}},value:{defaultValue:null,description:"Состояние фильтров",name:"value",required:!1,type:{name:"FiltersState"}},defaultValue:{defaultValue:null,description:"Начальное состояние фильтров",name:"defaultValue",required:!1,type:{name:"Partial<TState>"}},onChange:{defaultValue:null,description:"Колбек изменения состояния фильтров",name:"onChange",required:!1,type:{name:"((filters: TState) => void)"}},filters:{defaultValue:null,description:"Массив чипов",name:"filters",required:!0,type:{name:"ChipChoiceRowFilter[]"}},size:{defaultValue:{value:"s"},description:"Размер",name:"size",required:!1,type:{name:"enum",value:[{value:'"s"'},{value:'"m"'},{value:'"xs"'}]}},className:{defaultValue:null,description:"CSS-класс",name:"className",required:!1,type:{name:"string"}},showClearButton:{defaultValue:{value:"true"},description:"Скрыть/показать кнопку очиски фильтров",name:"showClearButton",required:!1,type:{name:"boolean"}},showAddButton:{defaultValue:{value:"true"},description:"Скрыть/показать кнопку добавления фильров",name:"showAddButton",required:!1,type:{name:"boolean"}},visibleFilters:{defaultValue:null,description:"Состояние для видимых фильтров",name:"visibleFilters",required:!1,type:{name:"string[]"}},onVisibleFiltersChange:{defaultValue:null,description:"Коллбек на изменение видимых фильтров",name:"onVisibleFiltersChange",required:!1,type:{name:"((value: string[]) => void)"}}}}}catch{}export{k as C,p as a,R4 as h};
